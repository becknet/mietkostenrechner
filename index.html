<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Mietkostenrechner</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha3/dist/css/bootstrap.min.css" rel="stylesheet">
</head>

<body>
    <div class="container my-5">
        <h1 class="text-center mb-1">Mietkostenrechner</h1>
        <h2 class="text-center mb-4">Chalet Lärchji Bellwald</h2>
        <form id="calculatorForm">
            <div class="mb-3">
                <label for="startDate" class="form-label">Startdatum</label>
                <input type="date" class="form-control" id="startDate" required onchange="updateMinEndDate()">
            </div>
            <div class="mb-3">
                <label for="endDate" class="form-label">Enddatum</label>
                <input type="date" class="form-control" id="endDate" required>
            </div>
            <div class="mb-3">
                <label for="numAdults" class="form-label">Erwachsene (16+ Jahre)</label>
                <input type="number" class="form-control" id="numAdults" min="1" value="0" required>
            </div>
            <div class="mb-3">
                <label for="numTeens" class="form-label">Kinder (6-15 Jahre)</label>
                <input type="number" class="form-control" id="numTeens" min="0" value="0">
            </div>
            <div class="mb-3">
                <label for="numChildren" class="form-label">Kinder (0-5 Jahre)</label>
                <input type="number" class="form-control" id="numChildren" min="0" value="0">
            </div>
            <div class="mb-3">
                <label for="numSauna" class="form-label">Anzahl Saunagänge</label>
                <input type="number" class="form-control" id="numSauna" min="0" value="0">
            </div>
            <div class="d-flex justify-content-between">
                <button type="button" class="btn btn-secondary" data-bs-toggle="modal"
                    data-bs-target="#priceInfoModal">Preisinformationen</button>
                <button type="button" class="btn btn-primary" onclick="calculateCosts()">Berechnen</button>
            </div>
        </form>

        <div class="mt-4" id="result" style="display: none;">
            <h2>Ergebnisse</h2>
            <ul class="list-group">
                <li class="list-group-item">Grundgebühr: <span id="baseCost">0</span> CHF</li>
                <li class="list-group-item">Personengebühr: <span id="personCost">0</span> CHF</li>
                <li class="list-group-item">Kurtaxe: <span id="taxCost">0</span> CHF</li>
                <li class="list-group-item">Sauna: <span id="saunaCost">0</span> CHF</li>
                <li class="list-group-item fw-bold">Gesamtkosten: <span id="totalCost">0</span> CHF</li>
            </ul>
        </div>
    </div>

    <!-- Modal for Price Information -->
    <div class="modal fade" id="priceInfoModal" tabindex="-1" aria-labelledby="priceInfoModalLabel" aria-hidden="true">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h4 class="modal-title" id="priceInfoModalLabel">Preisinformationen</h4>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body" id="priceInfoContent">
                    <!-- Preisinformationen werden dynamisch eingefügt -->
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Schließen</button>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Konstanten für Preise
        const PRICES = {
            WEEK_SUMMER: 450, // Grundkosten Woche Sommer
            WEEK_WINTER: 650, // Grundkosten Woche Winter
            DAY_SUMMER: 70, // Grundkosten Tag Sommer
            DAY_WINTER: 100, // Grundkosten Tag Winter
            PERSON_FEE: 7.5, // Personenkosten
            TAX_TEENS: 2.9, // Kurtaxe 6-15
            TAX_ADULTS: 5.8, // Kurtaxe Erwachsen
            SAUNA: 15 // Sauna
        };

        // Modal mit dynamischen Preisinformationen befüllen
        document.addEventListener('DOMContentLoaded', () => {
            const priceInfoContent = document.getElementById('priceInfoContent');
            priceInfoContent.innerHTML = `
                <h5>Grundgebühr</h5>
                    <ul>
                        <li><strong>Woche:</strong> Sommer ${PRICES.WEEK_SUMMER} CHF, Winter ${PRICES.WEEK_WINTER} CHF</li>
                        <li><strong>Tag:</strong> Sommer ${PRICES.DAY_SUMMER} CHF, Winter ${PRICES.DAY_WINTER} CHF</li>
                    </ul>
                    <h5>Personengebühr</h5>
                    <p>${PRICES.PERSON_FEE.toFixed(2)} CHF pro Tag pro Person (ab 6 Jahren)</p>
                    <h5>Kurtaxe</h5>
                    <ul>
                        <li>${PRICES.TAX_TEENS.toFixed(2)} CHF pro Tag (Kinder 6-15 Jahre)</li> 
                        <li>${PRICES.TAX_ADULTS.toFixed(2)} CHF pro Tag (Erwachsene ab 16 Jahren)</li>
                    </ul>
                    <h5>Sauna</h5> 
                    <p>${PRICES.SAUNA} CHF pro Saunagang</p>
            `;
        });

        function updateMinEndDate() {
            const startDate = document.getElementById('startDate').value;
            const endDateInput = document.getElementById('endDate');

            if (startDate) {
                endDateInput.min = startDate;
            }
        }

        function calculateCosts() {
            const startDate = new Date(document.getElementById('startDate').value);
            const endDate = new Date(document.getElementById('endDate').value);
            const numAdults = parseInt(document.getElementById('numAdults').value) || 0;
            const numTeens = parseInt(document.getElementById('numTeens').value) || 0;
            const numChildren = parseInt(document.getElementById('numChildren').value) || 0;
            const numSauna = parseInt(document.getElementById('numSauna').value) || 0;

            if (isNaN(startDate) || isNaN(endDate)) {
                alert('Bitte geben Sie ein gültiges Start- und Enddatum ein.');
                return;
            }

            if (endDate <= startDate) {
                alert('Das Enddatum muss größer als das Startdatum sein.');
                return;
            }
            
            // Anzahl Tage
            const dayInMillis = 24 * 60 * 60 * 1000;
            const totalDays = Math.ceil((endDate - startDate) / dayInMillis);

            // Sommer oder Winter?
            const startMonth = startDate.getMonth() + 1; // Januar ist 0
            const isWinter = startMonth >= 10 || startMonth <= 4;
            const weekRate = isWinter ? PRICES.WEEK_WINTER : PRICES.WEEK_SUMMER;
            const dayRate = isWinter ? PRICES.DAY_WINTER : PRICES.DAY_SUMMER;

            // Wochenpreis oder Tagespreis?
            const fullWeeks = Math.floor(totalDays / 7);
            const extraDays = totalDays % 7;
            const baseCost = fullWeeks * weekRate + extraDays * dayRate;
            
            // Personenkosten
            const personCost = (numAdults + numTeens) * PRICES.PERSON_FEE * totalDays;

            // Kurtaxe
            const taxCost = (numTeens * PRICES.TAX_TEENS + numAdults * PRICES.TAX_ADULTS) * totalDays;

            // Sauna
            const saunaCost = numSauna * PRICES.SAUNA;
            
            // Total
            const totalCost = baseCost + personCost + taxCost + saunaCost;

            document.getElementById('baseCost').innerText = baseCost.toFixed(2);
            document.getElementById('personCost').innerText = personCost.toFixed(2);
            document.getElementById('taxCost').innerText = taxCost.toFixed(2);
            document.getElementById('saunaCost').innerText = saunaCost.toFixed(2);
            document.getElementById('totalCost').innerText = totalCost.toFixed(2);

            document.getElementById('result').style.display = 'block';
        }
    </script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha3/dist/js/bootstrap.bundle.min.js"></script>
</body>

</html>